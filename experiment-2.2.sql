-- QUESTION 2.2

CREATE TABLE YEARS_TBL(
 ID INT,
 YEAR INT,
 NPV INT
);

CREATE TABLE QUERIES_TBL(
ID INT,
YEAR INT
);

INSERT INTO YEARS_TBL(ID, YEAR, NPV) 
VALUES
(101, 2017, 150),
(202, 2020, 45),
(303, 2018, 60),
(101, 2018, 175),
(404, 2010, 95),
(505, 2005, 20),
(606, 2020, 110),
(202, 2019, 10);

INSERT INTO QUERIES_TBL(ID, YEAR) 
VALUES
(101, 2018),
(404, 2010),
(505, 2006),
(202, 2017),
(202, 2019),
(202, 2020),
(303, 2018);

SELECT Q.*, ISNULL(Y.NPV, 0) AS [NPV]
FROM
YEARS_TBL AS Y
RIGHT OUTER JOIN
QUERIES_TBL AS Q
ON 
Y.ID = Q.ID 
AND
Y.YEAR = Q.YEAR;
